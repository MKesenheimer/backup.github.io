<!DOCTYPE html><html lang="de"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Der QDC geht in die zweite Runde. Software! - Physik, Elektronik und mehr…</title><meta name="description" content="Der Nano-Quadrocopter geht in die zweite Runde(Die erste Runde findet ihr hier).Nach langer Wartezeit gibt es jetzt endlich mal wieder ein paar Updates und sogar erste Codeschnippsel. Ich muss leidvoll gestehen, dass ich nur sehr langsam an diesem Projekt weiterkomme, aber was mittlerweile daraus geworden ist, seht ihr hier."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://mkesenheimer.github.io/der-qdc-geht-in-die-zweite-runde-software.html"><link rel="alternate" type="application/atom+xml" href="https://mkesenheimer.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://mkesenheimer.github.io/feed.json"><meta property="og:title" content="Der QDC geht in die zweite Runde. Software!"><meta property="og:site_name" content="Physik, Elektronik und mehr…"><meta property="og:description" content="Der Nano-Quadrocopter geht in die zweite Runde(Die erste Runde findet ihr hier).Nach langer Wartezeit gibt es jetzt endlich mal wieder ein paar Updates und sogar erste Codeschnippsel. Ich muss leidvoll gestehen, dass ich nur sehr langsam an diesem Projekt weiterkomme, aber was mittlerweile daraus geworden ist, seht ihr hier."><meta property="og:url" content="https://mkesenheimer.github.io/der-qdc-geht-in-die-zweite-runde-software.html"><meta property="og:type" content="article"><link rel="stylesheet" href="https://mkesenheimer.github.io/assets/css/style.css?v=b8d5114de68142a2c09dcc242b2b7485"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://mkesenheimer.github.io/der-qdc-geht-in-die-zweite-runde-software.html"},"headline":"Der QDC geht in die zweite Runde. Software!","datePublished":"2014-01-31T21:47","dateModified":"2024-09-13T14:27","description":"Der Nano-Quadrocopter geht in die zweite Runde(Die erste Runde findet ihr hier).Nach langer Wartezeit gibt es jetzt endlich mal wieder ein paar Updates und sogar erste Codeschnippsel. Ich muss leidvoll gestehen, dass ich nur sehr langsam an diesem Projekt weiterkomme, aber was mittlerweile daraus geworden ist, seht ihr hier.","author":{"@type":"Person","name":"Matthias Kesenheimer","url":"https://mkesenheimer.github.io/authors/matthias-kesenheimer/"},"publisher":{"@type":"Organization","name":"Matthias Kesenheimer"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><header class="top js-header"><a class="logo" href="https://mkesenheimer.github.io/">Physik, Elektronik und mehr…</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://mkesenheimer.github.io/home.html">Home</a></li></ul></nav><div class="search"><div class="search__overlay js-search-overlay"><div class="wrapper search__overlay-inner"></div></div><button class="search__btn btn--icon js-search-btn" aria-label="Search"><svg height="18" width="18" role="presentation" focusable="false"><use xlink:href="https://mkesenheimer.github.io/assets/svg/svg-map.svg#search"/></svg></button></div></header><main class="post"><article class="content"><div class="hero hero--noimage"><header class="hero__content"><div class="wrapper"><h1>Der QDC geht in die zweite Runde. Software!</h1><div class="feed__meta content__meta"><a href="https://mkesenheimer.github.io/authors/matthias-kesenheimer/" class="feed__author">Matthias Kesenheimer</a> <time datetime="2014-01-31T21:47" class="feed__date">Januar 31, 2014</time></div></div></header></div><div class="entry-wrapper content__entry"><p style="text-align:justify;"><strong>Der Nano-Quadrocopter geht in die zweite Runde</strong></p><p style="text-align:justify;">(Die erste Runde findet ihr <a title="Der Nano-Quadrocopter" href="http://deralchemist.wordpress.com/2012/10/08/der-nano-quadrocopter/" target="_blank">hier</a>).</p><p style="text-align:justify;">Nach langer Wartezeit gibt es jetzt endlich mal wieder ein paar Updates und sogar erste Codeschnippsel. Ich muss leidvoll gestehen, dass ich nur sehr langsam an diesem Projekt weiterkomme, aber was mittlerweile daraus geworden ist, seht ihr hier.</p><p style="text-align:justify;">Tja, eine Diplomarbeit zu schreiben benötigt viel Zeit und Aufmerksamkeit. Deshalb geht es mit meinen anderen Projekten nur sehr langsam voran. Aber ich habe vor einigen Wochen Verstärkung bekommen! Ja, das glaubt man kaum, aber ich arbeite mittlerweile mit <a title="Homepage öffnen" href="http://www.harald-sattler.de/html/xnq.htm" target="_blank">Harald Sattler</a> zusammen, der selbst an einem Quadrocopter-Projekt bastelt. Durch ihn hat mein Projekt neuen Schub bekommen, weshalb ich euch meine Fortschritte zeigen möchte. Harald arbeitet mit einem ähnlichen Setup. Er verwendet ebenfalls einen XMega32 Prozessor, seine Schaltung ist größtenteils identisch (bis auf Pinbelegung) zu meiner Schaltung, deshalb bietet es sich an, an einem gemeinsamen Code zu schreiben. Doch alles Schritt für Schritt.</p><p style="text-align:justify;">Zuerst einmal etwas zur <a title="Download" href="http://www.mediafire.com/download/xu586e7fupqppk6/QuadroCalibration.zip" target="_blank">Benutzeroberfläche</a>, mit der man meinen Quadrocopter einstellen und wichtige Daten sichtbar machen lassen kann. Die Benutzeroberfläche wurde für Mac OS X in Cocoa - eine spezielle Programmiersprache für die Oberflächen von Mac OS X - von mir geschrieben. Der Quadrocopter kommuniziert mit diesem Programm über eine serielle Schnittstelle, beispielsweise über einen USB-To-Seriell-Adapter oder über einen <a title="Arduino.cc" href="http://arduino.cc" target="_blank">Arduino</a>. Auf Befehl des Programms sendet der Quadrocopter entweder die aktuellen Winkel- oder bestimmte Debugwerte und trägt sie in einem Diagramm gegen die Zeitachse ab. Damit ist eine sehr gute Datenkontrolle möglich und man sieht ganz genau, was auf dem Quadrocopter gerade so passiert.</p><p style="text-align:justify;">Die Oberfläche ist an sich selbsterklärend. Es gibt einen Bereich wo die vom Quadrocopter empfangene Daten abgetragen werden und einen Bereich wo man neue Daten eintragen kann, um sie an den Quadrocopter zu schicken. Diese Daten können zum Beispiel bestimmte Konfigurationswerte für die PID-Regelschleife sein. Außerdem lassen sich über die Benutzeroberfläche die Motoren starten oder ausschalten, falls das aus irgendwelchen Gründen nötig sein sollte.</p><figure class="aligncenter wp-image-747"><a href="https://deralchemist.wordpress.com/wp-content/uploads/2014/01/gui.png"><img loading="lazy" src="https://mkesenheimer.github.io/media/posts/13/gui.png" alt="" width="398" height="318" sizes="(max-width: 1920px) 100vw, 1920px" srcset="https://mkesenheimer.github.io/media/posts/13/responsive/gui-xs.png 640w, https://mkesenheimer.github.io/media/posts/13/responsive/gui-sm.png 768w, https://mkesenheimer.github.io/media/posts/13/responsive/gui-md.png 1024w, https://mkesenheimer.github.io/media/posts/13/responsive/gui-lg.png 1366w, https://mkesenheimer.github.io/media/posts/13/responsive/gui-xl.png 1600w, https://mkesenheimer.github.io/media/posts/13/responsive/gui-2xl.png 1920w"></a></figure><p></p><p style="text-align:justify;">Den Code der Benutzeroberfläche habe ich <a title="Download" href="https://github.com/MKesenheimer/QDC_MK1_Quadrocopter" target="_blank">hier</a> veröffentlicht. Natürlich ist er mit Vorsicht zu genießen. Es ist noch nicht die endgültige Version und im Laufe der Entwicklung kann sich vielleicht noch einiges ändern. Zum Beispiel das Format des Datenstromes möchte ich bei Gelegenheit noch anpassen. Bis jetzt werden einzelne Datensätze als Ascii-Werte, die mit Kommas oder Strichpunkt voneinander getrennt sind, an die serielle Schnittstelle geschickt und vom Programm als String eingelesen. Ein Algorithmus trennt die einzelnen Datensätze voneinander und konvertiert sie wieder in Integer oder Double Werte. Das ist nicht sehr elegant und kann bestimmt irgendwie optimiert werden. Aber das hat denke ich noch Zeit. Zuerst sind andere Sachen wichtiger. Wen die Hintergründe genauer interessieren, sollte den Code herunterladen und darin stöbern. Die Routinen, die die Kommunikation zur serielle Schnittstelle bereitstellen, sind von einem anderen Projekt (<a title="ORSSerialPort" href="https://github.com/armadsen/ORSSerialPort" target="_blank">ORSSerialPort</a>) kopiert.</p><p style="text-align:justify;">Zu meinem Quadrocopter selber kann ich euch schon einmal diesen Code als Vorabversion präsentieren: <a title="Download" href="http://www.mediafire.com/download/fr4bpz8df4jhjb1/xNQ_QDC.zip" target="_blank">xNQ_QDC</a>. Wie gesagt, ist dieser Code in Zusammenarbeit mit <a title="Homepage öffnen" href="http://www.harald-sattler.de/html/xnq.htm" target="_blank">Harald Sattler</a> entstanden und eine Portierung der Multi-Wii-Firmware. Durch die Adaptierung an den XMega Prozessor geht einiges an Funktionalität der Multi-Wii-Firmware verloren, aber das meiste wird für meinen (und auch für Haralds) Quadrocopter nicht benötigt. Falls ihr beabsichtigt diesen Code zu verwenden denkt daran, dass womöglich einige Port Zuordnungen oder Timer an euer Projekt angepasst werden müssen. Noch ein Hinweis: Die Codeteile für meinen Quadrocopter (können mit #define QDCMK ausgewählt werden) funktionieren noch nicht alle. Die Codeteile von Haralds Quadrocopter (#define xNQ) funktionieren allerdings schon sehr gut, er konnte mit diese Code schon fliegen. Außerdem ist diese Firmware Version nicht mit der oben beschriebenen graphischen Benutzeroberfläche für Mac OS X kompatibel, sondern mit der GUI der Multi-Wii-Software, die <a title="Multi-Wii GUI" href="https://code.google.com/p/mw-wingui/" target="_blank">hier</a> zu finden ist.</p><p style="text-align:justify;"><strong>Update 25. September 2014:</strong></p><p style="text-align:left;">Das ganze Projekt ist seit neuestem auch auf meiner Github-Seite zu finden: <a title="Github" href="https://github.com/MKesenheimer/QDC_MK1_Quadrocopter" target="_blank">QDC_MK1_Quadrocopter</a></p><p style="text-align:left;">Es wurden in den letzten Tagen einige Änderungen am bestehenden Code vorgenommen, z.B. wurde der unverständliche PID-Algorithmus der MultiWii-Firmware durch einen eigenen Algorithmus ausgetauscht. Obwohl nun Fließkomma-Berechnungen vom Mikrokontroller durchgeführt werden müssen, ändert sich die Geschwindigkeit der PID-Schleife nicht. Im Gegenteil, die Schleifenfrequenz beträgt nun satte 800Hz! Desweiteren werden die Winkel anders berechnet und die Filterung der Daten geschieht nun durch einen Kalman Filter. Insgesamt ist der Code nun (hoffentlich) besser verständlich und klarer strukturiert als der ursprüngliche MultiWii-Code. Die ersten Flugversuche fallen ebenfalls sehr positiv aus.</p><p style="text-align:left;">Hier geht es weiter in die <a title="Jungfernflug" href="https://deralchemist.wordpress.com/2014/10/05/jungfernflug-des-nanocopters/">dritte Runde</a>.</p></div><footer class="content__footer"><div class="entry-wrapper"><p class="content__updated">This article was updated on September 13, 2024</p><div class="content__actions"><ul class="content__tag"><li><a href="https://mkesenheimer.github.io/tags/cocoa/">Cocoa</a></li><li><a href="https://mkesenheimer.github.io/tags/diy/">DIY</a></li><li><a href="https://mkesenheimer.github.io/tags/mac-os-x/">Mac OS X</a></li><li><a href="https://mkesenheimer.github.io/tags/multiwii/">MultiWii</a></li><li><a href="https://mkesenheimer.github.io/tags/nanocopter/">Nanocopter</a></li><li><a href="https://mkesenheimer.github.io/tags/orsserial/">ORSSerial</a></li><li><a href="https://mkesenheimer.github.io/tags/quadrocopter/">Quadrocopter</a></li></ul><div class="content__share"><button class="btn--icon content__share-button js-content__share-button"><svg width="20" height="20" aria-hidden="true"><use xlink:href="https://mkesenheimer.github.io/assets/svg/svg-map.svg#share"></use></svg> <span>Share It</span></button><div class="content__share-popup js-content__share-popup"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmkesenheimer.github.io%2Fder-qdc-geht-in-die-zweite-runde-software.html" class="js-share facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://mkesenheimer.github.io/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fmkesenheimer.github.io%2Fder-qdc-geht-in-die-zweite-runde-software.html&amp;via=Physik%2C%20Elektronik%20und%20mehr%E2%80%A6&amp;text=Der%20QDC%20geht%20in%20die%20zweite%20Runde.%20Software!" class="js-share twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://mkesenheimer.github.io/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fmkesenheimer.github.io%2Fder-qdc-geht-in-die-zweite-runde-software.html&amp;media=undefined&amp;description=Der%20QDC%20geht%20in%20die%20zweite%20Runde.%20Software!" class="js-share pinterest" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://mkesenheimer.github.io/assets/svg/svg-map.svg#pinterest"/></svg> <span>Pinterest</span></a></div></div></div><div class="content__bio bio"><div><h3 class="h4 bio__name"><a href="https://mkesenheimer.github.io/authors/matthias-kesenheimer/" rel="author">Matthias Kesenheimer</a></h3></div></div></div><nav class="content__nav"><div class="wrapper"><div class="content__nav-inner"><div class="content__nav-prev"><a href="https://mkesenheimer.github.io/longboard-selbstbau-nr-2.html" class="content__nav-link" rel="prev"><div><span>Previous</span> Longboard Selbstbau Nr. 2</div></a></div><div class="content__nav-next"><a href="https://mkesenheimer.github.io/neue-alte-moebel.html" class="content__nav-link" rel="next"><div><span>Next</span> Neue alte Möbel...</div></a></div></div></div></nav></footer></article></main><footer class="footer footer--glued"><div class="wrapper"><div class="footer__copyright"><p>Matthias Kesenheimer, 2024</p></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg width="20" height="20"><use xlink:href="https://mkesenheimer.github.io/assets/svg/svg-map.svg#toparrow"/></svg></button></div></footer><script defer="defer" src="https://mkesenheimer.github.io/assets/js/scripts.min.js?v=ffcbea6c02c8178d10092962b235a5b0"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>